-- QNA
DROP TABLE QNA_TB CASCADE CONSTRAINTS;

CREATE TABLE QNA_TB(
bno number primary key, -- seq_qna 게시글 번호
product varchar2(50), -- 전시명
writer varchar2(50) not null, -- 작성자id(userid랑 조인)
name varchar2(50), --작성자 이름
title varchar2(200) not null, --제목
content clob, --내용
reg_date date default sysdate, --작성일자 
viewcnt number default 0, --조회수
reply_state varchar2(50), --답변상태
filename varchar2(2000),
filesize number default 0,

foreign key(writer) references MEMBER_TB(userid)
);

--시퀀스
drop sequence seq_qna;
create sequence seq_qna start with 1 increment by 1;


insert into qna_tb (bno,title,content,writer) values
(2,'제목test','내용test','kim');
select * from qna_tb;
commit;

--QNA 답글
DROP TABLE QNA_REPLY_TB;

CREATE TABLE QNA_REPLY_TB(
rno number not null primary key, -- seq_qna_reply 댓글번호
bno number default 0, --게시글 번호
content clob, --내용
writer varchar2(50) not null, --작성자
reg_date date default sysdate, --작성일
update_date date default sysdate --수정일
);

--foreign key 제약조건 추가
ALTER TABLE QNA_REPLY_TB ADD CONSTRAINT FK_QNA_TB
FOREIGN KEY(bno) REFERENCES QNA_TB(bno);


--시퀀스
drop sequence seq_qna_reply;
create sequence seq_qna_reply start with 1 increment by 1;

--QNA 첨부파일 
DROP TABLE QNA_ATTACH_TB CASCADE CONSTRAINTS;
CREATE TABLE QNA_ATTACH_TB(
full_name varchar2(150) primary key,
bno number not null,
reg_date date default sysdate
);

--bno 컬럼에 foreign key 설정
alter table QNA_ATTACH_TB add constraint fk_QNA_ATTACH_TB
foreign key(bno) references QNA_TB(bno);

commit;