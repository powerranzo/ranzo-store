--REVIEW
DROP TABLE REVIEW_TB CASCADE CONSTRAINTS;

CREATE TABLE REVIEW_TB(
bno number primary key, -- seq_review 게시글 번호
product varchar2(50) not null, -- 전시명
writer varchar2(50) not null, -- 작성자id(userid랑 조인)
name varchar2(50), --작성자 이름
title varchar2(200) not null, --제목
content clob, --내용
reg_date date default sysdate, --작성일자 
viewcnt number default 0, --조회수
filename varchar2(2000),
filesize number default 0,
rating number default 5,
thumb number default 0,

foreign key(product) references EXHIBITION_TB(code),
foreign key(writer) references MEMBER_TB(userid)
);

--시퀀스
drop sequence seq_review;
create sequence seq_review start with 1 increment by 1;


INSERT INTO REVIEW_TB(bno, product, writer, title, content) VALUES(SEQ_REVIEW.nextval, 'testcode01','kim', 'review title1', 'review kim 1 ');
INSERT INTO REVIEW_TB(bno, product, writer, title, content) VALUES(SEQ_REVIEW.nextval, 'testcode03','kim', 'review title3', 'review kim 3');
INSERT INTO REVIEW_TB(bno, product, writer, title, content) VALUES(SEQ_REVIEW.nextval, 'testcode03','hong', 'review title3', 'review hong 3');

SELECT * FROM REVIEW_TB;


--REVIEW 답글
DROP TABLE REVIEW_REPLY_TB;

CREATE TABLE REVIEW_REPLY_TB (
rno number not null primary key, -- seq_qna_reply 댓글번호
bno number default 0, --게시글 번호
content clob, --내용
writer varchar2(50) not null, --작성자
reg_date date default sysdate, --작성일
update_date date default sysdate --수정일
);

--foreign key 제약조건 추가
ALTER TABLE REVIEW_REPLY_TB ADD CONSTRAINT FK_REVIEW_TB
FOREIGN KEY(bno) REFERENCES REVIEW_TB(bno);


--시퀀스
drop sequence seq_review_reply;
create sequence seq_review_reply start with 1 increment by 1;

--REVIEW 첨부파일 
DROP TABLE REVIEW_ATTACH_TB CASCADE CONSTRAINTS;
CREATE TABLE REVIEW_ATTACH_TB(
full_name varchar2(150) primary key,
bno number not null,
reg_date date default sysdate
);

--bno 컬럼에 foreign key 설정
alter table REVIEW_ATTACH_TB add constraint fk_REVIEW_ATTACH_TB
foreign key(bno) references REVIEW_TB(bno);

commit;